(window.beeketingWPJP=window.beeketingWPJP||[]).push([[1],{305:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.COOKIE_DISCOUNT_CODE="bk_discount_code",e.COOKIE_DISCOUNT_CODE_ADDED="bk_discount_code_added",e.COOKIE_DISCOUNT_CODE_SOURCE="bk_discount_code_source",e.TRACKING_PRODUCT_EVENTS={VIEW:"product_view"},e.SHOP_AJAX_CART="bk_shop_ajax_cart",e.USE_FB_PIXEL_TRACK="useFbPixelTrack",e.FB_PIXEL_NO_FORCE="FbPixelNoForce",e.ADD_TO_CART_IDENTITY="addToCartIdentity",e.STORAGE_LAST_STEP_UP_SELL="sm_last_step_up_sell",e.CURRENT_SALES_MOTIVATOR_LAST_STEP_OFFER="current_sales_motivator_last_step_offer",e.NGUYEN_KIM_PLATFORM="nguyenkim",e.APP_CODE_BEEPLUS="beeplus",e.APP_CODE_BSALES="bsales",e.APP_CODE_PREC="precommend",e.COOKIE_CART_TOKEN_KEY="_beeketing_cart_token",e.COOKIE_CART_DATA="_beeketing_cart_content"},307:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=P(r(316)),a=P(r(35)),f=P(r(9)),c=P(r(3)),n=P(r(118)),u=P(r(15)),o=P(r(308)),d=P(r(119)),s=P(r(21)),l=P(r(26)),_=P(r(6)),p=P(r(20)),h=P(r(10)),v=P(r(365)),g=P(r(122)),m=P(r(123)),C=P(r(75)),k=P(r(70)),b=P(r(47)),T=r(28),E=P(r(130));function P(t){return t&&t.__esModule?t:{default:t}}e.default={DISCOUNT_TYPE_FREE_SHIPPING:"free_shipping",DISCOUNT_TYPE_FIXED_AMOUNT:"fixed_amount",DISCOUNT_TYPE_PERCENTAGE:"percentage",createInvoice:function(e){var t=k.default.current(),r=this.buildDiscountLineItems(),a={cart_token:t.token,line_items:r.convertedItems,sources:r.sources,note:l.default.current().cart.getOrderNote()},n=this.getDiscountApplied();if(!(0,h.default)(n)&&t.totalAmount>=n.minimumAmount)switch(n.type){case this.DISCOUNT_TYPE_FREE_SHIPPING:a.free_shipping=1;break;case this.DISCOUNT_TYPE_PERCENTAGE:a.applied_discount={value_type:this.DISCOUNT_TYPE_PERCENTAGE,value:n.value,amount:this.toFixed(t.totalAmount*n.value/100,!1),description:n.description};break;case this.DISCOUNT_TYPE_FIXED_AMOUNT:var u=n.value>t.totalAmount?t.totalAmount:n.value;a.applied_discount={value_type:this.DISCOUNT_TYPE_FIXED_AMOUNT,value:u,amount:u,description:n.description}}var o=new c.default.Deferred;return d.default.isInTestGroup("create_draft_order_v2").then(function(t){t&&(a=(0,f.default)(a)),c.default.post(e,a).always(function(t){if(t&&t.success&&t.draft_order.invoice_url){var e=t.draft_order.invoice_url;t.draft_order.checkout_url&&0<=t.draft_order.checkout_url.search("/checkouts/")&&(e=t.draft_order.checkout_url.replace("https://checkout.shopify.com",window.location.origin)),o.resolve(e)}else o.reject()})}),o},buildDiscountLineItems:function(){var i=this,c=[],d=0,s=this.getCartItems(),l=[],e=this.getDiscountProducts();return(0,a.default)(e).forEach(function(t){e[t].forEach(function(e){var t=(0,m.default)(s,function(t){return t.variantId===e.variant_id&&0<t.quantity}),r=i.toFixed(e.old_price-e.new_price);if(0<=t&&0<r){var a=s[t],n=e.quantity>a.quantity?a.quantity:e.quantity,u=[{name:"_bk_discount",value:(0,f.default)({old_price:e.old_price,new_price:e.new_price})}];(0,h.default)(a.properties)||(0,g.default)(a.properties,function(t,e){u.push({name:e,value:t})});var o=i.toFixed(r*n);d+=o,c=(0,v.default)(c.concat(e.sources)),l.push({custom:!1,variant_id:e.variant_id,quantity:n,properties:u,applied_discount:{value_type:i.DISCOUNT_TYPE_FIXED_AMOUNT,value:r,amount:o,description:e.sources.join(", ")}}),s[t].quantity-=n}})}),s.forEach(function(t){var r=[];(0,h.default)(t.properties)||(0,g.default)(t.properties,function(t,e){r.push({name:e,value:t})}),0<t.quantity&&l.push({custom:!1,variant_id:t.variantId,quantity:t.quantity,properties:r})}),{convertedItems:l,sources:c,totalDiscount:d}},addDiscountProduct:function(t,e,r,a,n,u,o){var i=this.getDiscountProducts(),c=k.default.current();i[t]||(i[t]=[]);var d=(0,m.default)(i[t],{variant_id:e,old_price:a,new_price:r}),s=0<=d&&i[t][d],l=Boolean((0,C.default)(c.items,{variantId:e})&&s&&!o),f={quantity:l?s.quantity+n:parseInt(n,10),sources:l?(0,v.default)(u.concat(s.sources)):u,variant_id:parseInt(e,10),old_price:parseFloat(a),new_price:parseFloat(r)};s?i[t][d]=f:i[t].push(f),this.saveToLocalStorage(i,{},!0)},removeDiscountProduct:function(r,a){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null,u=this.getDiscountProducts(),o=!1;u&&u[r]&&(u[r].forEach(function(t,e){t.variant_id!==a||n&&-1===t.sources.indexOf(n)||(delete u[r][e],u[r]=u[r].filter(function(t){return t}),(0,i.default)(u[r]).length||delete u[r],o=!0)}),o&&this.saveToLocalStorage(u,{},!0))},getDiscountProducts:function(){var e=u.default.isSupportLocalStorage()?localStorage.getItem("bk_discount_products"):s.default.get("bk_discount_products");try{e=JSON.parse(e)}catch(t){e={}}return e&&e[k.default.current().token]&&e[k.default.current().token].discountProducts?e[k.default.current().token].discountProducts:{}},applyDiscount:function(t,e,r){var a=3<arguments.length&&void 0!==arguments[3]?arguments[3]:0,n=4<arguments.length&&void 0!==arguments[4]?arguments[4]:"",u=this.getDiscountProducts();if(e===this.DISCOUNT_TYPE_PERCENTAGE&&(100<r||r<1)||e===this.DISCOUNT_TYPE_FIXED_AMOUNT&&r<1)throw new Error("Discount value is invalid.");e&&r&&this.saveToLocalStorage(u,{id:t,type:e,value:r,description:n,minimumAmount:0<=Number(a)?Number(a):0})},removeDiscount:function(t,e){var r=this.getDiscountApplied();if(r.id&&(t===r.id||e&&-1!==r.id.indexOf(e))){var a=this.getDiscountProducts();this.saveToLocalStorage(a,!1)}},getDiscountApplied:function(){var e=u.default.isSupportLocalStorage()?localStorage.getItem("bk_discount_products"):s.default.get("bk_discount_products");try{e=JSON.parse(e)}catch(t){e={}}return e&&e[k.default.current().token]&&e[k.default.current().token].discount?e[k.default.current().token].discount:{}},saveToLocalStorage:function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},r=2<arguments.length&&void 0!==arguments[2]&&arguments[2],a={};!1!==e&&(a=(0,h.default)(e)?this.getDiscountApplied():e);var n={};n[k.default.current().token]={discountProducts:t,discount:a},u.default.isSupportLocalStorage()?localStorage.setItem("bk_discount_products",(0,f.default)(n)):s.default.set("bk_discount_products",(0,f.default)(n),{expires:(0,p.default)().add(30,"days").toDate()}),r&&(clearTimeout(this.saveToLocalStorageTimeoutId),this.saveToLocalStorageTimeoutId=setTimeout(function(){return E.default.updateCartFromHost(!1,!0)},500)),b.default.trigger(T.DISCOUNT_PRODUCTS_UPDATED)},calculateTotalDiscountPrice:function(){var t=(0,f.default)(this.getDiscountProducts()),e=(0,f.default)(this.getCartItems());if(!this.calculateCache||this.calculateCache.discountJson!==t||this.calculateCache.cartItemsJson!==e){var r=this.buildDiscountLineItems().totalDiscount;this.calculateCache={discountJson:t,totalDiscount:r,cartItemsJson:e}}return this.calculateCache.totalDiscount},isUsingDraftOrder:function(){if("shopify"===_.default.getParam("shop","shop").platform){if(!(0,h.default)(this.getDiscountProducts()))return!0;var t=this.getDiscountApplied();if(!(0,h.default)(t))return k.default.current().totalAmount>=t.minimumAmount}return!1},listenCheckoutButtons:function(t){if("cart"===n.default.getContext().type||t){if(!this.isUsingDraftOrder())return;o.default.removeClickListener((0,c.default)(l.default.current().element.getCheckoutButton()),function(t){t.bind("click",function(t){var e=(0,c.default)(t.target);return(o.default.lastClickedOriginCheckoutButton=e).attr("disabled","disabled"),o.default.originButton[e.data("bk-btn-id")]&&o.default.originButton[e.data("bk-btn-id")].attr("disabled","disabled"),void 0!==e.attr("bk-changed-quantity")?b.default.listen(T.CART_UPDATE,function(){o.default.triggerCheckout()}):o.default.triggerCheckout(),t.preventDefault(),t.stopImmediatePropagation(),!1})})}},goToInvoicePage:function(t){var e=t,r=l.default.current().currentLocale();r&&(e+=(-1===e.indexOf("?")?"?":"&")+"locale="+r),u.default.redirect(e)},toFixed:function(t){var e=!(1<arguments.length&&void 0!==arguments[1])||arguments[1];if(0<t%1){if(e)return Number(parseFloat(t).toFixed(2));var r=t.toString().search("\\.");if(0<=r)return Number(t.toString().substring(0,r+3))}return Number(t)},setCartItems:function(t){this.cartItems=t},getCartItems:function(){return this.cartItems?this.cartItems:JSON.parse((0,f.default)(k.default.current().items))},getAppCode:function(){return _.default.hasAppParam("bsales","draft_order_url")&&!_.default.hasAppParam("bsales","isFake")?"bsales":!!(_.default.hasAppParam("cboost","draft_order_url")||_.default.hasAppParam("bsales","isFake")&&_.default.hasAppParam("cboost","draft_order_url"))&&"cboost"}}},308:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n(r(48)),a=n(r(49)),u=n(r(3)),i=n(r(74)),c=n(r(6)),d=n(r(118)),s=n(r(307)),l=n(r(119)),f=n(r(26)),_=n(r(320)),p=r(28),h=n(r(50)),v=r(305),g=n(r(70));function n(t){return t&&t.__esModule?t:{default:t}}var m={originButton:{},autoId:0,removeClickListener:function(t,r){var a=void 0,n=void 0;t.each(function(t,e){(0,u.default)(e).hasClass("bk-btn-clone")||((a=(0,u.default)(e).data("bk-btn-id"))||(m.autoId+=1,a=m.autoId,(0,u.default)(e).data("bk-btn-id",a),m.originButton[a]=(0,u.default)(e)),(n=(0,u.default)(e).clone()).attr("onclick","event.preventDefault();"),n.data("bk-btn-id",a),n.addClass("bk-btn-clone"),(0,u.default)(e).replaceWith(n),"function"==typeof r&&r(n))})},revertClickListener:function(t,r){t&&t.length||r(null);var a=void 0;t.each(function(t,e){(0,u.default)(e).hasClass("bk-btn-clone")&&(a=(0,u.default)(e).data("bk-btn-id"),(0,u.default)(e).replaceWith(m.originButton[a]),"function"==typeof r&&m.originButton[a]&&r(m.originButton[a]))})},lastClickedOriginCheckoutButton:null,triggerCheckout:function(){var u=this;return(0,a.default)(o.default.mark(function t(){var r,a,n,e;return o.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return r=s.default.getAppCode(),a=c.default.getParam("shop","shop"),n=i.default.getBackendUrl(c.default.getAppParam(r,"draft_order_url")),t.next=5,l.default.isInTestGroup("create_draft_order_v2").then(function(t){t&&(n=i.default.getGApiUrl("/draft-order/create_draft_order/"+r+"/"+a.id))});case 5:if(_.default.sendInitiateCheckoutEvent(),e=function(){if(!window.beeketingFireReachedCheckout)if(d.default.getContext().platform===v.NGUYEN_KIM_PLATFORM&&window.offerID){var t={offer_id:window.offerID};h.default.track(p.REACHED_CHECKOUT,t)}else{var e={cart_token:g.default.current().token,shop_platform:a.platform};h.default.track(p.REACHED_CHECKOUT,e)}r&&s.default.isUsingDraftOrder()?s.default.createInvoice(n).then(s.default.goToInvoicePage).fail(f.default.current().page_util.forceGoToCheckoutPage):f.default.current().page_util.forceGoToCheckoutPage()},m.lastClickedOriginCheckoutButton)return m.revertClickListener(m.lastClickedOriginCheckoutButton,function(t){r&&s.default.isUsingDraftOrder()?s.default.createInvoice(n).then(s.default.goToInvoicePage).fail(f.default.current().page_util.forceGoToCheckoutPage):t.length?(f.default.current().cart.correctCartItemsQuantity(),t.trigger("click"),setTimeout(e,1e3)):f.default.current().page_util.forceGoToCheckoutPage()}),t.abrupt("return");t.next=10;break;case 10:e();case 11:case"end":return t.stop()}},t,u)}))()}};e.default=m},312:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var f=u(r(310)),a=u(r(46)),n=u(r(6)),_=u(r(26)),p=u(r(3));function u(t){return t&&t.__esModule?t:{default:t}}function h(t,e){var r=t.toFixed(e).toString();return r.match(/^\.\d+/)?"0"+r:r}var o={getShopCurrency:function(){return n.default.getParam("shop","shop").currency},format:function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"${{amount}}",r=this,a=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null,n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null,u=_.default.current();e=u.getCurrentCurrencyFormat(e);var o="",i=t=u.getCurrentCurrencyAmount(t);if((0,f.default)(parseFloat(t)))o=t;else{var c=/\{\{\s*(\w+)\s*\}\}/;i=100*t;var d=e.match(c);if(null!=d&&1<d.length)switch(e.match(c)[1]){case"amount":o=h(i/100,2).replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1,");break;case"amount_no_decimals":o=h(i/100,0).replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1,");break;case"amount_with_comma_separator":o=h(i/100,2).replace(/\./,",").replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1.");break;case"amount_no_decimals_with_comma_separator":o=h(i/100,0).replace(/\./,",").replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1.");break;case"amount_no_decimals_with_space_separator":o=h(i/100,0).replace(/\./," ").replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1 ");break;case"amount_no_trailing_zeros":o=h(i/100,2).replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1,");break;case"amount_with_space_separator":o=h(i/100,2).replace(/\./," ").replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1.")}o=e.replace(c,o)}var s=(0,p.default)("<div/>").html(o).text(),l=(0,p.default)("<span>");return l.css("float","none"),n&&l.attr("style",n),a&&l.attr("data-primal-currency",a),l.addClass("money"),l.html(s),this.isUsingCurrencySwitcher()&&(l.attr("data-currency",this.getShopCurrency()),l.attr("data-original-value",i),clearInterval(this.interval),this.interval=setInterval(function(){clearInterval(r.interval),r.convertPriceToCorrectCurrency()},200)),l.get(0).outerHTML},isUsingCurrencySwitcher:function(){var t=void 0;return void 0!==(t=window.Currency)&&"function"==typeof t.convertAll&&t.currentCurrency?"jqueryCurrency":!(void 0===(t=window.DoublyGlobalCurrency)||"function"!=typeof t.convertAll||!t.currentCurrency)&&"DoublyGlobalCurrency"},convertPriceToCorrectCurrency:function(){var t=this.getShopCurrency(),e=void 0;switch(this.isUsingCurrencySwitcher()){case"jqueryCurrency":t!==(e=window.Currency).currentCurrency&&e.convertAll(this.getShopCurrency(),e.currentCurrency);break;case"DoublyGlobalCurrency":t!==(e=window.DoublyGlobalCurrency).currentCurrency&&e.convertAll(e.currentCurrency)}}};a.default.filter("currency",function(t){return o.format(t,n.default.getParam("shop","shop").moneyFormat)}),e.default=o},320:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=r(305),n=d(r(6)),u=d(r(4)),o=d(r(70)),i=d(r(312)),c=d(r(3));function d(t){return t&&t.__esModule?t:{default:t}}e.default={track:function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[];try{"function"==typeof window.fbq&&window.fbq("track",t,e)}catch(t){(0,u.default)("Error durring call fb pixelMagic track")}},isUsing:function(t){n.default.getParam("shop",a.FB_PIXEL_NO_FORCE)&&(t=!1);var e=0!==Number(n.default.getParam("shop",a.USE_FB_PIXEL_TRACK));return(t||e)&&"function"==typeof window.fbq},sendInitiateCheckoutEvent:function(){var t=0<arguments.length&&void 0!==arguments[0]&&arguments[0],e=o.default.current();(n.default.getParam("shop","fb_pixel_force_initiate_checkout")||this.isUsing(t)&&e&&e.items&&e.items.length)&&this.track("InitiateCheckout",{content_type:"product_group",currency:i.default.getShopCurrency(),value:Number(e.totalAmount).toFixed(2),content_ids:e.items.map(function(t){return t.productRefId}),num_items:e.items.reduce(function(t,e){return t.quantity+e.quantity}),source:"beeketing"})},sendAddToCartEvent:function(t){var e=1<arguments.length&&void 0!==arguments[1]&&arguments[1];if(this.isUsing(e)){var r=void 0;(0,c.default)('img[src^="https://www.facebook.com/tr?"]').each(function(){var t=(0,c.default)(this).attr("src").split("[product_catalog_id]=");void 0!==t[1]&&(r=t[1])});var a={content_ids:t,content_type:"product_group",source:"beeketing"};r&&(a.product_catalog_id=r,a.content_type="product"),this.track("AddToCart",a)}}}}}]);