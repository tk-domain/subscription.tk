if(void 0===trafficguardObject){var trafficguardObject,trafficguard=function(){this.timeStampExpirationDelay=18e4,this.serverAjaxDecisionURL="https://trafficguardapp.com/ajaxroute.php",this.localStorage_AccessDeny="tg_accessDeny",this.localStorage_AccessAllow="tg_accessEntry",this.localStorage_AccessDeny_timestamp="tg_accessDeny_timeStamp",this.localStorage_AccessAllow_timestamp="tg_accessAllow_timeStamp",this.localStorage_redirectURLRemembered="tg_redirectURLremembered",this.localStorage_reaction="tg_reaction",this.localStorage_redirectURL="tg_redirectURL",this.localStorage_ipInfosArray="tg_ipInfosArray"};trafficguard.prototype.checkLocalStorageAccessDeny=function(){if("undefined"!=typeof Storage&&("true"===this.getLocalStorageItem(this.localStorage_AccessDeny)&&null!==this.getLocalStorageItem(this.localStorage_AccessDeny_timestamp)&&(new Date).getTime()-this.getLocalStorageItem(this.localStorage_AccessDeny_timestamp)<this.timeStampExpirationDelay))return!0;return!1},trafficguard.prototype.checkLocalStorageAccessEntry=function(){if("undefined"!=typeof Storage&&("true"===this.getLocalStorageItem(this.localStorage_AccessAllow)&&null!==this.getLocalStorageItem(this.localStorage_AccessAllow_timestamp)&&(new Date).getTime()-this.getLocalStorageItem(this.localStorage_AccessAllow_timestamp)<this.timeStampExpirationDelay))return!0;return!1},trafficguard.prototype.getSavedReaction=function(){return"undefined"!=typeof Storage?this.getLocalStorageItem(this.localStorage_reaction):null},trafficguard.prototype.setSavedReaction=function(t){return"undefined"!=typeof Storage&&this.setLocalStorageItem(this.localStorage_reaction,t),!1},trafficguard.prototype.getSavedRedirectURL=function(){return"undefined"!=typeof Storage?this.getLocalStorageItem(this.localStorage_redirectURL):null},trafficguard.prototype.setSavedRedirectURL=function(t){return"undefined"!=typeof Storage&&this.setLocalStorageItem(this.localStorage_redirectURL,t),!1},trafficguard.prototype.redirectOutsideSite=function(t){this.stopPageLoading(),this.beforeRedirection(),this.setLocalStorageItem(this.localStorage_redirectURLRemembered,t),window.location.href=t},trafficguard.prototype.destroyHtml=function(){this.hideHTMLDOM(),this.stopPageLoading(),document.getElementsByTagName("html")[0].innerHTML=""},trafficguard.prototype.stopPageLoading=function(){try{window.stop()}catch(t){document.execCommand("Stop")}},trafficguard.prototype.beforeRedirection=function(){return this.forbidFutureAccess(),!0},trafficguard.prototype.getLocalStorageItem=function(t){return"undefined"!=typeof Storage&&"undefined"!=typeof localStorage&&void 0!==localStorage.getItem?localStorage.getItem(t):null},trafficguard.prototype.forbidFutureAccess=function(){return this.setLocalStorageItem(this.localStorage_AccessDeny,"true"),this.setLocalStorageItem(this.localStorage_AccessAllow,"false"),this.setLocalStorageItem(this.localStorage_AccessDeny_timestamp,(new Date).getTime()),this.setLocalStorageItem(this.localStorage_AccessAllow_timestamp,null),!0},trafficguard.prototype.authorizeFutureAccess=function(){return this.setLocalStorageItem(this.localStorage_AccessDeny,"false"),this.setLocalStorageItem(this.localStorage_AccessAllow,"true"),this.setLocalStorageItem(this.localStorage_AccessDeny_timestamp,null),this.setLocalStorageItem(this.localStorage_AccessAllow_timestamp,(new Date).getTime()),!0},trafficguard.prototype.setLocalStorageItem=function(t,e){return"undefined"!=typeof Storage&&"undefined"!=typeof localStorage&&void 0!==localStorage.setItem&&(localStorage.setItem(t,e),!0)},trafficguard.prototype.hideHTMLDOM=function(){return document.getElementsByTagName("html")[0].style.display="none",!0},trafficguard.prototype.showHTMLDOM=function(){return document.getElementsByTagName("html")[0].style.display="",!0},trafficguard.prototype.beforeBlockedScript=function(){return!0},trafficguard.prototype.beforeAllowedScript=function(){return!0},trafficguard.prototype.endScript=function(){return delete trafficguard,delete trafficguardObject,!0},trafficguard.prototype.getShopifyShopDomain=function(){return"undefined"!=typeof Shopify&&"string"==typeof Shopify.shop?Shopify.shop:"string"==typeof tgshopdomain?tgshopdomain:null},trafficguard.prototype.userIsNotAllowed=function(t,e){if(t=void 0!==t?t:null,e=void 0!==e?e:null,this.setSavedReaction(t),this.setSavedRedirectURL(e),this.forbidFutureAccess(),this.beforeBlockedScript(),"redirect"===t&&e){if(this.getCurrentURL()===this.getLocalStorageItem(this.localStorage_redirectURLRemembered))return this.showHTMLDOM(),!0;this.destroyHtml(),this.redirectOutsideSite(e)}else this.destroyHtml();return this.endScript(),!0},trafficguard.prototype.userIsAllowed=function(){return tg_ipInfos||(tg_ipInfos=JSON.parse(this.getLocalStorageItem(this.localStorage_ipInfosArray))),this.authorizeFutureAccess(),this.showHTMLDOM(),this.beforeAllowedScript(),this.endScript(),!0},trafficguard.prototype.fireIpInfoEvent=function(){if(tg_ipInfos){var t=new CustomEvent("tg_ipinfo",{detail:tg_ipInfos});return window.dispatchEvent(t),!0}return!1},trafficguard.prototype.initEvents=function(){var t=this;if(t.checkLocalStorageAccessDeny()){var e=t.getSavedReaction(),o=t.getSavedRedirectURL();return t.userIsNotAllowed(e,o),!0}if(t.checkLocalStorageAccessEntry())return t.userIsAllowed(),!0;t.sendJsonp(t.serverAjaxDecisionURL,{shop:t.getShopifyShopDomain()},function(e){if("Success"===e.status){if(tg_ipInfos={},void 0!==e.ipInfo&&(tg_ipInfos=e.ipInfo,t.setLocalStorageItem(t.localStorage_ipInfosArray,JSON.stringify(e.ipInfo))),tg_ipInfos.decision=e.decision,"block"===e.decision.behaviour){if("redirect"===e.decision.reaction&&void 0!==e.decision.reactionDetails.redirectURL){var o=e.decision.reaction,r=e.decision.reactionDetails.redirectURL;return t.userIsNotAllowed(o,r),!0}return t.userIsNotAllowed("hide",null),!0}return t.userIsAllowed(),!0}return console.log("error"+e.code),t.userIsAllowed(),!0})},trafficguard.prototype.getCurrentURL=function(){return window.location.href},trafficguard.prototype.htmlDOMshowManager=function(){var t=this;return this.hideHTMLDOM(),setTimeout(function(){t.showHTMLDOM()},2e3),!0},trafficguard.prototype.sendJsonp=function(t,e,o){var r=document.createElement("script");document.tgcallback=function(t){o(t)};var i="?";i+="callback=document.tgcallback&";for(var a in e)e.hasOwnProperty(a)&&(i+=a+"="+e[a]+"&");"&"===i.substring(i.length-1)&&(i=i.substring(0,i.length-1)),r.src=t+i,document.getElementsByTagName("head")[0].appendChild(r).tgremove()},Element.prototype.tgremove=function(){this.parentElement.removeChild(this)},NodeList.prototype.tgremove=function(){for(var t=this.length-1;t>=0;t--)this[t]&&this[t].parentElement&&this[t].parentElement.removeChild(this[t])};var tg_ipInfos=null;(trafficguardObject=new trafficguard).initEvents()}